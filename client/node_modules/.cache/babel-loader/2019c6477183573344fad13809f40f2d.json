{"ast":null,"code":"import _defineProperty from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/poncho/Documents/PROJET/moonboard-project/client/src/components/Admin/HandleArticle.js\";\nimport React, { Component } from \"react\";\nimport RemoveArticle from \"./RemoveArticle\";\nimport Button from \"@material-ui/core/Button\";\nimport withMobileDialog from \"@material-ui/core/withMobileDialog\";\nimport ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\nimport ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\nimport ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\nimport Typography from \"@material-ui/core/Typography\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogPopin from \"../Dialog/Dialog\";\nimport { Query, Mutation } from \"react-apollo\";\nimport { GET_CHAPTERS, ADD_CHAPTER, DELETE_CHAPTER, ADD_CHAPTER_DESCRIPTION } from \"../../queries\";\nvar removeChapterDialog = {\n  title: \"Remove Chapter\",\n  description: \"Are you sure you want to delete this chapter? All articles associated with this chapter will be permanently deleted\",\n  error: \"Sorry, deleting your chapter did not work...\",\n  success: \"Great, your chapter is now removed!\"\n};\nvar addChapterDialog = {\n  title: \"Add Chapter\",\n  description: \"Are you sure you want to add a chapter?\",\n  error: \"Sorry, adding your chapter did not work...\",\n  success: \"Great, your chapter is now added!\"\n};\n\nvar HandleArticle =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(HandleArticle, _Component);\n\n  function HandleArticle() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, HandleArticle);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(HandleArticle)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      openSuccessSnackBar: false,\n      openErrorSnackBar: false,\n      openDialog: false,\n      openForm: false,\n      chapterDescription: \"\",\n      chapterSelected: \"\",\n      action: function action() {},\n      expanded: 1,\n      dialog: {\n        title: \"\",\n        description: \"\",\n        success: \"\",\n        error: \"\"\n      }\n    };\n\n    _this.handleClose = function (deleteArticle) {\n      _this.setState({\n        openDialog: false\n      });\n    };\n\n    _this.handleCloseForm = function () {\n      _this.setState({\n        openForm: false\n      });\n    };\n\n    _this.handleFormChange = function (event) {\n      var _event$target = event.target,\n          name = _event$target.name,\n          value = _event$target.value;\n\n      _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.handleClickOpenForm = function (event, _id) {\n      _this.setState({\n        openForm: true,\n        chapterSelected: _id\n      }, function () {\n        _this.setState({\n          expanded: 0\n        });\n      });\n    };\n\n    _this.handleChange = function (panel) {\n      return function (event, expanded) {\n        _this.setState({\n          expanded: expanded ? panel : false\n        });\n      };\n    };\n\n    _this.handleAction = function (action, dialog) {\n      _this.setState({\n        openDialog: true,\n        action: action,\n        dialog: dialog\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(HandleArticle, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var expanded = this.state.expanded;\n      var _this$state = this.state,\n          openDialog = _this$state.openDialog,\n          action = _this$state.action,\n          dialog = _this$state.dialog,\n          chapterDescription = _this$state.chapterDescription,\n          chapterSelected = _this$state.chapterSelected;\n      return React.createElement(Query, {\n        query: GET_CHAPTERS,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, function (_ref) {\n        var loading = _ref.loading,\n            error = _ref.error,\n            data = _ref.data;\n        if (loading) return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, \"Loading...\");\n        if (error) return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, \"Error :(\");\n        return React.createElement(\"div\", {\n          className: \"HandleArticle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111\n          },\n          __self: this\n        }, React.createElement(DialogPopin, {\n          withDialog: true,\n          openDialog: openDialog,\n          handleClose: _this2.handleClose,\n          action: action,\n          dialog: dialog,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }), React.createElement(Mutation, {\n          mutation: ADD_CHAPTER_DESCRIPTION,\n          variables: {\n            chapterSelected: chapterSelected,\n            chapterDescription: chapterDescription\n          },\n          update: function update(cache, _ref2) {\n            var data = _ref2.data;\n            var chapters = cache.readQuery({\n              query: GET_CHAPTERS\n            }).getChapters;\n            cache.writeQuery({\n              query: GET_CHAPTERS,\n              data: {\n                getChapters: chapters.map(function (chapter) {\n                  return chapter._id !== data.addChapterDescription._id && chapter;\n                }).filter(function (chapter) {\n                  return chapter !== false;\n                })\n              }\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, function (addChapterDescription, _ref3) {\n          var loading = _ref3.loading,\n              error = _ref3.error;\n          return React.createElement(Dialog, {\n            open: _this2.state.openForm,\n            onClose: _this2.handleCloseForm,\n            \"aria-labelledby\": \"form-dialog-title\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 141\n            },\n            __self: this\n          }, React.createElement(DialogTitle, {\n            id: \"form-dialog-title\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 146\n            },\n            __self: this\n          }, \"Add a chapter description\"), React.createElement(DialogContent, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 149\n            },\n            __self: this\n          }, React.createElement(TextField, {\n            id: \"outlined-multiline-flexible\",\n            label: \"Multiline\",\n            multiline: true,\n            name: \"chapterDescription\",\n            value: _this2.state.chapterDescription,\n            onChange: _this2.handleFormChange,\n            margin: \"normal\",\n            variant: \"outlined\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 150\n            },\n            __self: this\n          })), React.createElement(DialogActions, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 161\n            },\n            __self: this\n          }, React.createElement(Button, {\n            onClick: _this2.handleClose,\n            color: \"primary\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 162\n            },\n            __self: this\n          }, \"Cancel\"), React.createElement(Button, {\n            onClick: _this2.handleClose,\n            color: \"primary\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 165\n            },\n            __self: this\n          }, \"Add\")));\n        }), data.getChapters.sort(function (a, b) {\n          return a.number > b.number;\n        }).map(function (_ref4) {\n          var _id = _ref4._id,\n              number = _ref4.number;\n          return React.createElement(\"div\", {\n            key: _id,\n            className: \"HandleArticle__Section\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 176\n            },\n            __self: this\n          }, React.createElement(Mutation, {\n            mutation: DELETE_CHAPTER,\n            variables: {\n              _id: _id,\n              number: number\n            },\n            update: function update(cache, _ref5) {\n              var data = _ref5.data;\n              var chapters = cache.readQuery({\n                query: GET_CHAPTERS\n              }).getChapters;\n              cache.writeQuery({\n                query: GET_CHAPTERS,\n                data: {\n                  getChapters: chapters.map(function (chapter) {\n                    return chapter._id !== data.deleteChapter._id && chapter;\n                  }).filter(function (chapter) {\n                    return chapter !== false;\n                  })\n                }\n              });\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 177\n            },\n            __self: this\n          }, function (deleteChapter, _ref6) {\n            var loading = _ref6.loading,\n                error = _ref6.error;\n            return React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 199\n              },\n              __self: this\n            }, React.createElement(\"form\", {\n              className: \"HandleArticle__AddChapter\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 200\n              },\n              __self: this\n            }, React.createElement(IconButton, {\n              className: \"HandleArticle__Section__Icon\",\n              \"aria-label\": \"Delete\",\n              onClick: function onClick() {\n                return _this2.handleAction(deleteChapter, removeChapterDialog);\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 201\n              },\n              __self: this\n            }, React.createElement(DeleteIcon, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 211\n              },\n              __self: this\n            }))), error && React.createElement(\"p\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 214\n              },\n              __self: this\n            }, \"Error :( Please try again\"));\n          }), React.createElement(ExpansionPanel, {\n            expanded: expanded === number,\n            onChange: _this2.handleChange(number),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 218\n            },\n            __self: this\n          }, React.createElement(ExpansionPanelSummary, {\n            className: \"HandleArticle__Section__Chapter__Header\",\n            expandIcon: React.createElement(ExpandMoreIcon, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 224\n              },\n              __self: this\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 222\n            },\n            __self: this\n          }, React.createElement(Typography, {\n            component: \"h1\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 226\n            },\n            __self: this\n          }, \"Chapitre \", number), React.createElement(Button, {\n            className: \"HandleArticle__Section__Chapter__Header__AddDescription\",\n            onClick: function onClick() {\n              return _this2.handleClickOpenForm(_id);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 229\n            },\n            __self: this\n          }, \"Add description\")), React.createElement(ExpansionPanelDetails, {\n            className: \"HandleArticle__Section__Chapter__Content\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 236\n            },\n            __self: this\n          }, React.createElement(RemoveArticle, {\n            chapter: number,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 237\n            },\n            __self: this\n          }))));\n        }), React.createElement(Mutation, {\n          mutation: ADD_CHAPTER,\n          variables: {\n            number: data.getChapters.length + 1\n          },\n          update: function update(cache, _ref7) {\n            var data = _ref7.data;\n            var chapters = cache.readQuery({\n              query: GET_CHAPTERS\n            }).getChapters;\n            cache.writeQuery({\n              query: GET_CHAPTERS,\n              data: {\n                getChapters: chapters.concat([data.addChapter])\n              }\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 243\n          },\n          __self: this\n        }, function (addChapter, _ref8) {\n          var loading = _ref8.loading,\n              error = _ref8.error;\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 259\n            },\n            __self: this\n          }, React.createElement(\"form\", {\n            className: \"HandleArticle__AddChapter\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 260\n            },\n            __self: this\n          }, React.createElement(Button, {\n            className: \"HandleArticle__AddChapter__Button\",\n            variant: \"outlined\",\n            onClick: function onClick() {\n              return _this2.handleAction(addChapter, addChapterDialog);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 261\n            },\n            __self: this\n          }, loading ? \"Loading...\" : \"Add a chapter\")), error && React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 271\n            },\n            __self: this\n          }, \"Error :( Please try again\"));\n        }));\n      });\n    }\n  }]);\n\n  return HandleArticle;\n}(Component);\n\nexport default withMobileDialog()(HandleArticle);","map":{"version":3,"sources":["/home/poncho/Documents/PROJET/moonboard-project/client/src/components/Admin/HandleArticle.js"],"names":["React","Component","RemoveArticle","Button","withMobileDialog","ExpansionPanel","ExpansionPanelDetails","ExpansionPanelSummary","Typography","ExpandMoreIcon","IconButton","DeleteIcon","TextField","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","DialogPopin","Query","Mutation","GET_CHAPTERS","ADD_CHAPTER","DELETE_CHAPTER","ADD_CHAPTER_DESCRIPTION","removeChapterDialog","title","description","error","success","addChapterDialog","HandleArticle","state","openSuccessSnackBar","openErrorSnackBar","openDialog","openForm","chapterDescription","chapterSelected","action","expanded","dialog","handleClose","deleteArticle","setState","handleCloseForm","handleFormChange","event","target","name","value","handleClickOpenForm","_id","handleChange","panel","handleAction","loading","data","cache","chapters","readQuery","query","getChapters","writeQuery","map","chapter","addChapterDescription","filter","sort","a","b","number","deleteChapter","length","concat","addChapter"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport RemoveArticle from \"./RemoveArticle\";\nimport Button from \"@material-ui/core/Button\";\nimport withMobileDialog from \"@material-ui/core/withMobileDialog\";\nimport ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\nimport ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\nimport ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\nimport Typography from \"@material-ui/core/Typography\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogPopin from \"../Dialog/Dialog\";\n\nimport { Query, Mutation } from \"react-apollo\";\nimport {\n  GET_CHAPTERS,\n  ADD_CHAPTER,\n  DELETE_CHAPTER,\n  ADD_CHAPTER_DESCRIPTION\n} from \"../../queries\";\n\nconst removeChapterDialog = {\n  title: \"Remove Chapter\",\n  description:\n    \"Are you sure you want to delete this chapter? All articles associated with this chapter will be permanently deleted\",\n  error: \"Sorry, deleting your chapter did not work...\",\n  success: \"Great, your chapter is now removed!\"\n};\n\nconst addChapterDialog = {\n  title: \"Add Chapter\",\n  description: \"Are you sure you want to add a chapter?\",\n  error: \"Sorry, adding your chapter did not work...\",\n  success: \"Great, your chapter is now added!\"\n};\n\nclass HandleArticle extends Component {\n  state = {\n    openSuccessSnackBar: false,\n    openErrorSnackBar: false,\n    openDialog: false,\n    openForm: false,\n    chapterDescription: \"\",\n    chapterSelected: \"\",\n    action: () => {},\n    expanded: 1,\n    dialog: {\n      title: \"\",\n      description: \"\",\n      success: \"\",\n      error: \"\"\n    }\n  };\n\n  handleClose = deleteArticle => {\n    this.setState({ openDialog: false });\n  };\n\n  handleCloseForm = () => {\n    this.setState({\n      openForm: false\n    });\n  };\n\n  handleFormChange = event => {\n    const { name, value } = event.target;\n    this.setState({ [name]: value });\n  };\n\n  handleClickOpenForm = (event, _id) => {\n    this.setState({ openForm: true, chapterSelected: _id }, () => {\n      this.setState({ expanded: 0 });\n    });\n  };\n\n  handleChange = panel => (event, expanded) => {\n    this.setState({\n      expanded: expanded ? panel : false\n    });\n  };\n\n  handleAction = (action, dialog) => {\n    this.setState({\n      openDialog: true,\n      action: action,\n      dialog: dialog\n    });\n  };\n\n  render() {\n    const { expanded } = this.state;\n    const {\n      openDialog,\n      action,\n      dialog,\n      chapterDescription,\n      chapterSelected\n    } = this.state;\n    return (\n      <Query query={GET_CHAPTERS}>\n        {({ loading, error, data }) => {\n          if (loading) return <p>Loading...</p>;\n          if (error) return <p>Error :(</p>;\n          return (\n            <div className=\"HandleArticle\">\n              <DialogPopin\n                withDialog\n                openDialog={openDialog}\n                handleClose={this.handleClose}\n                action={action}\n                dialog={dialog}\n              />\n              <Mutation\n                mutation={ADD_CHAPTER_DESCRIPTION}\n                variables={{ chapterSelected, chapterDescription }}\n                update={(cache, { data }) => {\n                  const chapters = cache.readQuery({\n                    query: GET_CHAPTERS\n                  }).getChapters;\n                  cache.writeQuery({\n                    query: GET_CHAPTERS,\n                    data: {\n                      getChapters: chapters\n                        .map(\n                          chapter =>\n                            chapter._id !== data.addChapterDescription._id &&\n                            chapter\n                        )\n                        .filter(chapter => chapter !== false)\n                    }\n                  });\n                }}\n              >\n                {(addChapterDescription, { loading, error }) => (\n                  <Dialog\n                    open={this.state.openForm}\n                    onClose={this.handleCloseForm}\n                    aria-labelledby=\"form-dialog-title\"\n                  >\n                    <DialogTitle id=\"form-dialog-title\">\n                      Add a chapter description\n                    </DialogTitle>\n                    <DialogContent>\n                      <TextField\n                        id=\"outlined-multiline-flexible\"\n                        label=\"Multiline\"\n                        multiline\n                        name=\"chapterDescription\"\n                        value={this.state.chapterDescription}\n                        onChange={this.handleFormChange}\n                        margin=\"normal\"\n                        variant=\"outlined\"\n                      />\n                    </DialogContent>\n                    <DialogActions>\n                      <Button onClick={this.handleClose} color=\"primary\">\n                        Cancel\n                      </Button>\n                      <Button onClick={this.handleClose} color=\"primary\">\n                        Add\n                      </Button>\n                    </DialogActions>\n                  </Dialog>\n                )}\n              </Mutation>\n              {data.getChapters\n                .sort((a, b) => a.number > b.number)\n                .map(({ _id, number }) => {\n                  return (\n                    <div key={_id} className=\"HandleArticle__Section\">\n                      <Mutation\n                        mutation={DELETE_CHAPTER}\n                        variables={{ _id, number }}\n                        update={(cache, { data }) => {\n                          const chapters = cache.readQuery({\n                            query: GET_CHAPTERS\n                          }).getChapters;\n                          cache.writeQuery({\n                            query: GET_CHAPTERS,\n                            data: {\n                              getChapters: chapters\n                                .map(\n                                  chapter =>\n                                    chapter._id !== data.deleteChapter._id &&\n                                    chapter\n                                )\n                                .filter(chapter => chapter !== false)\n                            }\n                          });\n                        }}\n                      >\n                        {(deleteChapter, { loading, error }) => (\n                          <div>\n                            <form className=\"HandleArticle__AddChapter\">\n                              <IconButton\n                                className=\"HandleArticle__Section__Icon\"\n                                aria-label=\"Delete\"\n                                onClick={() =>\n                                  this.handleAction(\n                                    deleteChapter,\n                                    removeChapterDialog\n                                  )\n                                }\n                              >\n                                <DeleteIcon />\n                              </IconButton>\n                            </form>\n                            {error && <p>Error :( Please try again</p>}\n                          </div>\n                        )}\n                      </Mutation>\n                      <ExpansionPanel\n                        expanded={expanded === number}\n                        onChange={this.handleChange(number)}\n                      >\n                        <ExpansionPanelSummary\n                          className=\"HandleArticle__Section__Chapter__Header\"\n                          expandIcon={<ExpandMoreIcon />}\n                        >\n                          <Typography component=\"h1\">\n                            Chapitre {number}\n                          </Typography>\n                          <Button\n                            className=\"HandleArticle__Section__Chapter__Header__AddDescription\"\n                            onClick={() => this.handleClickOpenForm(_id)}\n                          >\n                            Add description\n                          </Button>\n                        </ExpansionPanelSummary>\n                        <ExpansionPanelDetails className=\"HandleArticle__Section__Chapter__Content\">\n                          <RemoveArticle chapter={number} />\n                        </ExpansionPanelDetails>\n                      </ExpansionPanel>\n                    </div>\n                  );\n                })}\n              <Mutation\n                mutation={ADD_CHAPTER}\n                variables={{ number: data.getChapters.length + 1 }}\n                update={(cache, { data }) => {\n                  const chapters = cache.readQuery({\n                    query: GET_CHAPTERS\n                  }).getChapters;\n                  cache.writeQuery({\n                    query: GET_CHAPTERS,\n                    data: {\n                      getChapters: chapters.concat([data.addChapter])\n                    }\n                  });\n                }}\n              >\n                {(addChapter, { loading, error }) => (\n                  <div>\n                    <form className=\"HandleArticle__AddChapter\">\n                      <Button\n                        className=\"HandleArticle__AddChapter__Button\"\n                        variant=\"outlined\"\n                        onClick={() =>\n                          this.handleAction(addChapter, addChapterDialog)\n                        }\n                      >\n                        {loading ? \"Loading...\" : \"Add a chapter\"}\n                      </Button>\n                    </form>\n                    {error && <p>Error :( Please try again</p>}\n                  </div>\n                )}\n              </Mutation>\n            </div>\n          );\n        }}\n      </Query>\n    );\n  }\n}\n\nexport default withMobileDialog()(HandleArticle);\n"]},"metadata":{},"sourceType":"module"}