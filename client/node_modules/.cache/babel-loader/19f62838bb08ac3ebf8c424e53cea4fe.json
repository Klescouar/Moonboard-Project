{"ast":null,"code":"import _classCallCheck from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/poncho/Documents/PROJET/moonboard-project/client/src/components/Admin/HandleArticle.js\";\nimport React, { Component } from 'react';\nimport RemoveArticle from './RemoveArticle';\nimport Button from '@material-ui/core/Button';\nimport withMobileDialog from '@material-ui/core/withMobileDialog';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SnackBarSuccess from '../SnackBar/SnackBarSuccess';\nimport SnackBarError from '../SnackBar/SnackBarError';\nimport { Query, Mutation } from 'react-apollo';\nimport { GET_CHAPTERS, ADD_CHAPTER, DELETE_CHAPTER } from '../../queries';\n\nvar HandleArticle =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(HandleArticle, _Component);\n\n  function HandleArticle() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, HandleArticle);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(HandleArticle)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      openSuccessSnackBar: false,\n      openErrorSnackBar: false,\n      openDialog: false,\n      deleteArticle: {},\n      expanded: 1\n    };\n\n    _this.handleClose = function (deleteArticle) {\n      _this.setState({\n        openDialog: false\n      });\n    };\n\n    _this.handleDialog = function (deleteArticle) {\n      _this.setState({\n        openDialog: true,\n        deleteArticle: deleteArticle\n      });\n    };\n\n    _this.handleChange = function (panel) {\n      return function (event, expanded) {\n        _this.setState({\n          expanded: expanded ? panel : false\n        });\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(HandleArticle, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var expanded = this.state.expanded;\n      return React.createElement(Query, {\n        query: GET_CHAPTERS,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47\n        },\n        __self: this\n      }, function (_ref) {\n        var loading = _ref.loading,\n            error = _ref.error,\n            data = _ref.data;\n        if (loading) return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 49\n          },\n          __self: this\n        }, \"Loading...\");\n        if (error) return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 50\n          },\n          __self: this\n        }, \"Error :(\");\n        return React.createElement(\"div\", {\n          className: \"HandleArticle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 52\n          },\n          __self: this\n        }, React.createElement(Dialog, {\n          className: \"RemoveArticle__Dialog\",\n          fullScreen: fullScreen,\n          open: _this2.state.openDialog,\n          onClose: _this2.handleClose,\n          \"aria-labelledby\": \"responsive-dialog-title\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 53\n          },\n          __self: this\n        }, React.createElement(DialogTitle, {\n          className: \"RemoveArticle__Dialog__Title\",\n          id: \"responsive-dialog-title\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 60\n          },\n          __self: this\n        }, 'Remove Article'), React.createElement(DialogContent, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66\n          },\n          __self: this\n        }, React.createElement(DialogContentText, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 67\n          },\n          __self: this\n        }, \"Are you sure you want to delete this article?\")), React.createElement(DialogActions, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71\n          },\n          __self: this\n        }, React.createElement(Button, {\n          onClick: _this2.handleDelete,\n          color: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }, \"Yes\"), React.createElement(Button, {\n          onClick: _this2.handleClose,\n          color: \"primary\",\n          autoFocus: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75\n          },\n          __self: this\n        }, \"No\"))), React.createElement(SnackBarSuccess, {\n          text: SUCCESS_TEXT,\n          open: _this2.state.openSuccessSnackBar,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 80\n          },\n          __self: this\n        }), React.createElement(SnackBarError, {\n          text: ERROR_TEXT,\n          open: _this2.state.openErrorSnackBar,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }), data.getChapters.sort(function (a, b) {\n          return a.number > b.number;\n        }).map(function (_ref2) {\n          var _id = _ref2._id,\n              number = _ref2.number;\n          return React.createElement(\"div\", {\n            key: _id,\n            className: \"HandleArticle__Section\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 92\n            },\n            __self: this\n          }, React.createElement(Mutation, {\n            mutation: DELETE_CHAPTER,\n            variables: {\n              _id: _id,\n              number: number\n            },\n            update: function update(cache, _ref3) {\n              var data = _ref3.data;\n              var chapters = cache.readQuery({\n                query: GET_CHAPTERS\n              }).getChapters;\n              cache.writeQuery({\n                query: GET_CHAPTERS,\n                data: {\n                  getChapters: chapters.map(function (chapter) {\n                    return chapter._id !== data.deleteChapter._id && chapter;\n                  }).filter(function (chapter) {\n                    return chapter !== false;\n                  })\n                }\n              });\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 93\n            },\n            __self: this\n          }, function (deleteChapter, _ref4) {\n            var loading = _ref4.loading,\n                error = _ref4.error;\n            return React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 115\n              },\n              __self: this\n            }, React.createElement(\"form\", {\n              className: \"HandleArticle__AddChapter\",\n              onSubmit: function onSubmit(e) {\n                e.preventDefault();\n                deleteChapter().then(function (res) {\n                  _this2.setState({\n                    openSuccessSnackBar: true,\n                    openDialog: false\n                  });\n\n                  setTimeout(function () {\n                    _this2.setState({\n                      openSuccessSnackBar: false\n                    });\n                  }, 3000);\n                }).catch(function (err) {\n                  _this2.setState({\n                    openErrorSnackBar: true,\n                    openDialog: false\n                  });\n\n                  setTimeout(function () {\n                    _this2.setState({\n                      openErrorSnackBar: false\n                    });\n                  }, 3000);\n                });\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 116\n              },\n              __self: this\n            }, React.createElement(IconButton, {\n              className: \"HandleArticle__Section__Icon\",\n              \"aria-label\": \"Delete\",\n              type: \"submit\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 145\n              },\n              __self: this\n            }, React.createElement(DeleteIcon, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 150\n              },\n              __self: this\n            }))), error && React.createElement(\"p\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 153\n              },\n              __self: this\n            }, \"Error :( Please try again\"));\n          }), React.createElement(ExpansionPanel, {\n            expanded: expanded === number,\n            onChange: _this2.handleChange(number),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 157\n            },\n            __self: this\n          }, React.createElement(ExpansionPanelSummary, {\n            className: \"HandleArticle__Section__Chapter__Header\",\n            expandIcon: React.createElement(ExpandMoreIcon, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 163\n              },\n              __self: this\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 161\n            },\n            __self: this\n          }, React.createElement(Typography, {\n            component: \"h1\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 165\n            },\n            __self: this\n          }, \"Chapite \", number)), React.createElement(ExpansionPanelDetails, {\n            className: \"HandleArticle__Section__Chapter__Content\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 169\n            },\n            __self: this\n          }, React.createElement(RemoveArticle, {\n            chapter: number,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 170\n            },\n            __self: this\n          }))));\n        }), React.createElement(Mutation, {\n          mutation: ADD_CHAPTER,\n          update: function update(cache, _ref5) {\n            var data = _ref5.data;\n            var chapters = cache.readQuery({\n              query: GET_CHAPTERS\n            }).getChapters;\n            cache.writeQuery({\n              query: GET_CHAPTERS,\n              data: {\n                getChapters: chapters.concat([data.addChapter])\n              }\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        }, function (addChapter, _ref6) {\n          var loading = _ref6.loading,\n              error = _ref6.error;\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 191\n            },\n            __self: this\n          }, React.createElement(\"form\", {\n            className: \"HandleArticle__AddChapter\",\n            onSubmit: function onSubmit(e) {\n              e.preventDefault();\n              addChapter({\n                variables: {\n                  number: data.getChapters.length + 1\n                }\n              });\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 192\n            },\n            __self: this\n          }, React.createElement(Button, {\n            className: \"HandleArticle__AddChapter__Button\",\n            variant: \"outlined\",\n            type: \"submit\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 201\n            },\n            __self: this\n          }, loading ? 'Loading...' : 'Add a chapter')), error && React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 209\n            },\n            __self: this\n          }, \"Error :( Please try again\"));\n        }));\n      });\n    }\n  }]);\n\n  return HandleArticle;\n}(Component);\n\nexport default withMobileDialog()(HandleArticle);","map":{"version":3,"sources":["/home/poncho/Documents/PROJET/moonboard-project/client/src/components/Admin/HandleArticle.js"],"names":["React","Component","RemoveArticle","Button","withMobileDialog","ExpansionPanel","ExpansionPanelDetails","ExpansionPanelSummary","Typography","ExpandMoreIcon","IconButton","DeleteIcon","SnackBarSuccess","SnackBarError","Query","Mutation","GET_CHAPTERS","ADD_CHAPTER","DELETE_CHAPTER","HandleArticle","state","openSuccessSnackBar","openErrorSnackBar","openDialog","deleteArticle","expanded","handleClose","setState","handleDialog","handleChange","panel","event","loading","error","data","fullScreen","handleDelete","SUCCESS_TEXT","ERROR_TEXT","getChapters","sort","a","b","number","map","_id","cache","chapters","readQuery","query","writeQuery","chapter","deleteChapter","filter","e","preventDefault","then","res","setTimeout","catch","err","concat","addChapter","variables","length"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport RemoveArticle from './RemoveArticle';\nimport Button from '@material-ui/core/Button';\nimport withMobileDialog from '@material-ui/core/withMobileDialog';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SnackBarSuccess from '../SnackBar/SnackBarSuccess';\nimport SnackBarError from '../SnackBar/SnackBarError';\n\nimport { Query, Mutation } from 'react-apollo';\nimport { GET_CHAPTERS, ADD_CHAPTER, DELETE_CHAPTER } from '../../queries';\n\nclass HandleArticle extends Component {\n  state = {\n    openSuccessSnackBar: false,\n    openErrorSnackBar: false,\n    openDialog: false,\n    deleteArticle: {},\n    expanded: 1\n  };\n\n  handleClose = deleteArticle => {\n    this.setState({ openDialog: false });\n  };\n\n  handleDialog = deleteArticle => {\n    this.setState({\n      openDialog: true,\n      deleteArticle: deleteArticle\n    });\n  };\n\n  handleChange = panel => (event, expanded) => {\n    this.setState({\n      expanded: expanded ? panel : false\n    });\n  };\n\n  render() {\n    const { expanded } = this.state;\n    return (\n      <Query query={GET_CHAPTERS}>\n        {({ loading, error, data }) => {\n          if (loading) return <p>Loading...</p>;\n          if (error) return <p>Error :(</p>;\n          return (\n            <div className=\"HandleArticle\">\n              <Dialog\n                className=\"RemoveArticle__Dialog\"\n                fullScreen={fullScreen}\n                open={this.state.openDialog}\n                onClose={this.handleClose}\n                aria-labelledby=\"responsive-dialog-title\"\n              >\n                <DialogTitle\n                  className=\"RemoveArticle__Dialog__Title\"\n                  id=\"responsive-dialog-title\"\n                >\n                  {'Remove Article'}\n                </DialogTitle>\n                <DialogContent>\n                  <DialogContentText>\n                    Are you sure you want to delete this article?\n                  </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                  <Button onClick={this.handleDelete} color=\"primary\">\n                    Yes\n                  </Button>\n                  <Button onClick={this.handleClose} color=\"primary\" autoFocus>\n                    No\n                  </Button>\n                </DialogActions>\n              </Dialog>\n              <SnackBarSuccess\n                text={SUCCESS_TEXT}\n                open={this.state.openSuccessSnackBar}\n              />\n              <SnackBarError\n                text={ERROR_TEXT}\n                open={this.state.openErrorSnackBar}\n              />\n              {data.getChapters\n                .sort((a, b) => a.number > b.number)\n                .map(({ _id, number }) => {\n                  return (\n                    <div key={_id} className=\"HandleArticle__Section\">\n                      <Mutation\n                        mutation={DELETE_CHAPTER}\n                        variables={{ _id, number }}\n                        update={(cache, { data }) => {\n                          const chapters = cache.readQuery({\n                            query: GET_CHAPTERS\n                          }).getChapters;\n                          cache.writeQuery({\n                            query: GET_CHAPTERS,\n                            data: {\n                              getChapters: chapters\n                                .map(\n                                  chapter =>\n                                    chapter._id !== data.deleteChapter._id &&\n                                    chapter\n                                )\n                                .filter(chapter => chapter !== false)\n                            }\n                          });\n                        }}\n                      >\n                        {(deleteChapter, { loading, error }) => (\n                          <div>\n                            <form\n                              className=\"HandleArticle__AddChapter\"\n                              onSubmit={e => {\n                                e.preventDefault();\n                                deleteChapter()\n                                  .then(res => {\n                                    this.setState({\n                                      openSuccessSnackBar: true,\n                                      openDialog: false\n                                    });\n                                    setTimeout(() => {\n                                      this.setState({\n                                        openSuccessSnackBar: false\n                                      });\n                                    }, 3000);\n                                  })\n                                  .catch(err => {\n                                    this.setState({\n                                      openErrorSnackBar: true,\n                                      openDialog: false\n                                    });\n                                    setTimeout(() => {\n                                      this.setState({\n                                        openErrorSnackBar: false\n                                      });\n                                    }, 3000);\n                                  });\n                              }}\n                            >\n                              <IconButton\n                                className=\"HandleArticle__Section__Icon\"\n                                aria-label=\"Delete\"\n                                type=\"submit\"\n                              >\n                                <DeleteIcon />\n                              </IconButton>\n                            </form>\n                            {error && <p>Error :( Please try again</p>}\n                          </div>\n                        )}\n                      </Mutation>\n                      <ExpansionPanel\n                        expanded={expanded === number}\n                        onChange={this.handleChange(number)}\n                      >\n                        <ExpansionPanelSummary\n                          className=\"HandleArticle__Section__Chapter__Header\"\n                          expandIcon={<ExpandMoreIcon />}\n                        >\n                          <Typography component=\"h1\">\n                            Chapite {number}\n                          </Typography>\n                        </ExpansionPanelSummary>\n                        <ExpansionPanelDetails className=\"HandleArticle__Section__Chapter__Content\">\n                          <RemoveArticle chapter={number} />\n                        </ExpansionPanelDetails>\n                      </ExpansionPanel>\n                    </div>\n                  );\n                })}\n              <Mutation\n                mutation={ADD_CHAPTER}\n                update={(cache, { data }) => {\n                  const chapters = cache.readQuery({\n                    query: GET_CHAPTERS\n                  }).getChapters;\n                  cache.writeQuery({\n                    query: GET_CHAPTERS,\n                    data: {\n                      getChapters: chapters.concat([data.addChapter])\n                    }\n                  });\n                }}\n              >\n                {(addChapter, { loading, error }) => (\n                  <div>\n                    <form\n                      className=\"HandleArticle__AddChapter\"\n                      onSubmit={e => {\n                        e.preventDefault();\n                        addChapter({\n                          variables: { number: data.getChapters.length + 1 }\n                        });\n                      }}\n                    >\n                      <Button\n                        className=\"HandleArticle__AddChapter__Button\"\n                        variant=\"outlined\"\n                        type=\"submit\"\n                      >\n                        {loading ? 'Loading...' : 'Add a chapter'}\n                      </Button>\n                    </form>\n                    {error && <p>Error :( Please try again</p>}\n                  </div>\n                )}\n              </Mutation>\n            </div>\n          );\n        }}\n      </Query>\n    );\n  }\n}\n\nexport default withMobileDialog()(HandleArticle);\n"]},"metadata":{},"sourceType":"module"}