{"ast":null,"code":"import _classCallCheck from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/poncho/Documents/PROJET/moonboard-project/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/poncho/Documents/PROJET/moonboard-project/client/src/components/Admin/HandleArticle.js\";\nimport React, { Component, Fragment } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport AddArticle from './AddArticle';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport Button from '@material-ui/core/Button';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport withMobileDialog from '@material-ui/core/withMobileDialog';\nimport SnackBarSuccess from '../SnackBar/SnackBarSuccess';\nimport SnackBarError from '../SnackBar/SnackBarError';\nimport { Query, Mutation } from 'react-apollo';\nimport { DELETE_ARTICLE, GET_ARTICLES, GET_CHAPTERS, ADD_CHAPTER } from '../../queries';\nvar ERROR_TEXT = 'Sorry, deleting your article did not work...';\nvar SUCCESS_TEXT = 'Great, your article is now removed!';\n\nvar HandleArticle =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(HandleArticle, _Component);\n\n  function HandleArticle() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, HandleArticle);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(HandleArticle)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      openSuccessSnackBar: false,\n      openErrorSnackBar: false,\n      openDialog: false,\n      deleteArticle: {}\n    };\n\n    _this.handleDelete = function () {\n      _this.state.deleteArticle().then(function () {\n        _this.setState({\n          openSuccessSnackBar: true,\n          openDialog: false\n        });\n\n        setTimeout(function () {\n          _this.setState({\n            openSuccessSnackBar: false\n          });\n        }, 3000);\n      }).catch(function () {\n        _this.setState({\n          openErrorSnackBar: true,\n          openDialog: false\n        });\n\n        setTimeout(function () {\n          _this.setState({\n            openErrorSnackBar: false\n          });\n        }, 3000);\n      });\n    };\n\n    _this.handleClose = function (deleteArticle) {\n      _this.setState({\n        openDialog: false\n      });\n    };\n\n    _this.handleDialog = function (deleteArticle) {\n      _this.setState({\n        openDialog: true,\n        deleteArticle: deleteArticle\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(HandleArticle, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var fullScreen = this.props.fullScreen;\n      return React.createElement(Query, {\n        query: GET_CHAPTERS,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, function (_ref) {\n        var loading = _ref.loading,\n            error = _ref.error,\n            data = _ref.data;\n        if (loading) return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }, \"Loading...\");\n        if (error) return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, \"Error :(\");\n        return React.createElement(\"div\", {\n          className: \"HandleArticle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 87\n          },\n          __self: this\n        }, data.getChapters.sort(function (a, b) {\n          return a.number > b.number;\n        }).map(function (_ref2) {\n          var _id = _ref2._id,\n              number = _ref2.number;\n          return React.createElement(\"div\", {\n            className: \"HandleArticle__Chapter\",\n            key: number,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 92\n            },\n            __self: this\n          }, React.createElement(\"h3\", {\n            className: \"HandleArticle__Chapter__Title\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 93\n            },\n            __self: this\n          }, \"Chapitre \", number), React.createElement(Query, {\n            query: GET_ARTICLES,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 96\n            },\n            __self: this\n          }, function (_ref3) {\n            var data = _ref3.data,\n                loading = _ref3.loading,\n                error = _ref3.error;\n            if (loading) return React.createElement(CircularProgress, {\n              className: \"Spinner\",\n              size: 50,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 100\n              },\n              __self: this\n            });\n            if (error) return React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 102\n              },\n              __self: this\n            }, \"Error\");\n            return React.createElement(\"div\", {\n              className: \"RemoveArticle\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 104\n              },\n              __self: this\n            }, React.createElement(Dialog, {\n              className: \"RemoveArticle__Dialog\",\n              fullScreen: fullScreen,\n              open: _this2.state.openDialog,\n              onClose: _this2.handleClose,\n              \"aria-labelledby\": \"responsive-dialog-title\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 105\n              },\n              __self: this\n            }, React.createElement(DialogTitle, {\n              className: \"RemoveArticle__Dialog__Title\",\n              id: \"responsive-dialog-title\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 112\n              },\n              __self: this\n            }, 'Remove Article'), React.createElement(DialogContent, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 118\n              },\n              __self: this\n            }, React.createElement(DialogContentText, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 119\n              },\n              __self: this\n            }, \"Are you sure you want to delete this article?\")), React.createElement(DialogActions, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 124\n              },\n              __self: this\n            }, React.createElement(Button, {\n              onClick: _this2.handleDelete,\n              color: \"primary\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 125\n              },\n              __self: this\n            }, \"Yes\"), React.createElement(Button, {\n              onClick: _this2.handleClose,\n              color: \"primary\",\n              autoFocus: true,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 131\n              },\n              __self: this\n            }, \"No\"))), React.createElement(SnackBarSuccess, {\n              text: SUCCESS_TEXT,\n              open: _this2.state.openSuccessSnackBar,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 140\n              },\n              __self: this\n            }), React.createElement(SnackBarError, {\n              text: ERROR_TEXT,\n              open: _this2.state.openErrorSnackBar,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 144\n              },\n              __self: this\n            }), !data.getArticles.length && React.createElement(\"p\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 149\n              },\n              __self: this\n            }, React.createElement(\"strong\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 150\n              },\n              __self: this\n            }, \"You have not added any articles yet\")), React.createElement(\"div\", {\n              className: \"RemoveArticle__Articles\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 155\n              },\n              __self: this\n            }, data.getArticles.map(function (article) {\n              return React.createElement(\"div\", {\n                className: \"RemoveArticle__Articles__Article\",\n                key: article._id,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 157\n                },\n                __self: this\n              }, React.createElement(Mutation, {\n                mutation: DELETE_ARTICLE,\n                variables: {\n                  _id: article._id\n                },\n                refetchQueries: function refetchQueries() {\n                  return [{\n                    query: GET_ARTICLES\n                  }];\n                },\n                update: function update(cache, _ref4) {\n                  var deleteArticle = _ref4.data.deleteArticle;\n\n                  var _cache$readQuery = cache.readQuery({\n                    query: GET_ARTICLES\n                  }),\n                      getArticles = _cache$readQuery.getArticles;\n\n                  cache.writeQuery({\n                    query: GET_ARTICLES,\n                    data: {\n                      getArticles: getArticles.filter(function (article) {\n                        return article._id !== deleteArticle._id;\n                      })\n                    }\n                  });\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 161\n                },\n                __self: this\n              }, function (deleteArticle) {\n                var attrs = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n                return React.createElement(Card, {\n                  className: \"RemoveArticle__Articles__Article__Card\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 192\n                  },\n                  __self: this\n                }, React.createElement(CardMedia, {\n                  className: \"RemoveArticle__Articles__Article__Card__Image\",\n                  image: require(\"../../assets/images/\".concat(article.image)),\n                  title: \"Contemplative Reptile\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 193\n                  },\n                  __self: this\n                }), React.createElement(CardContent, {\n                  className: \"RemoveArticle__Articles__Article__Card__Content\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 200\n                  },\n                  __self: this\n                }, React.createElement(Typography, {\n                  gutterBottom: true,\n                  variant: \"headline\",\n                  component: \"h2\",\n                  className: \"RemoveArticle__Articles__Article__Card__Content__Title\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 201\n                  },\n                  __self: this\n                }, article.title), React.createElement(Typography, {\n                  component: \"p\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 209\n                  },\n                  __self: this\n                }, article.description)), React.createElement(CardActions, {\n                  className: \"RemoveArticle__Articles__Article__Card__Action\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 213\n                  },\n                  __self: this\n                }, React.createElement(Button, {\n                  size: \"small\",\n                  onClick: function onClick() {\n                    return _this2.handleDialog(deleteArticle);\n                  },\n                  color: \"primary\",\n                  variant: \"outlined\",\n                  className: \"RemoveArticle__Articles__Article__Card__Action__Button\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 214\n                  },\n                  __self: this\n                }, attrs.loading ? 'deleting...' : 'DELETE')));\n              }));\n            })));\n          }), React.createElement(NavLink, {\n            className: \"HandleArticle__Chapter__AddArticle\",\n            to: \"/admin/backoffice/addArticle/chapter/\".concat(number),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 241\n            },\n            __self: this\n          }, \"ADD AN ARTICLE\"));\n        }), React.createElement(Mutation, {\n          mutation: ADD_CHAPTER,\n          update: function update(cache, _ref5) {\n            var data = _ref5.data;\n            var chapters = cache.readQuery({\n              query: GET_CHAPTERS\n            }).getChapters;\n            cache.writeQuery({\n              query: GET_CHAPTERS,\n              data: {\n                getChapters: chapters.concat([data.addChapter])\n              }\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 250\n          },\n          __self: this\n        }, function (addChapter, _ref6) {\n          var loading = _ref6.loading,\n              error = _ref6.error;\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 265\n            },\n            __self: this\n          }, React.createElement(\"form\", {\n            className: \"HandleArticle__AddChapter\",\n            onSubmit: function onSubmit(e) {\n              e.preventDefault();\n              addChapter({\n                variables: {\n                  number: data.getChapters.length + 1\n                }\n              });\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 266\n            },\n            __self: this\n          }, React.createElement(Button, {\n            className: \"HandleArticle__AddChapter__Button\",\n            variant: \"outlined\",\n            type: \"submit\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 275\n            },\n            __self: this\n          }, loading ? 'Loading...' : 'Add a chapter')), error && React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 283\n            },\n            __self: this\n          }, \"Error :( Please try again\"));\n        }));\n      });\n    }\n  }]);\n\n  return HandleArticle;\n}(Component);\n\nexport default withMobileDialog()(HandleArticle);","map":{"version":3,"sources":["/home/poncho/Documents/PROJET/moonboard-project/client/src/components/Admin/HandleArticle.js"],"names":["React","Component","Fragment","NavLink","BrowserRouter","Router","Route","AddArticle","Card","CardActions","CardContent","CardMedia","Button","Icon","Typography","CircularProgress","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","withMobileDialog","SnackBarSuccess","SnackBarError","Query","Mutation","DELETE_ARTICLE","GET_ARTICLES","GET_CHAPTERS","ADD_CHAPTER","ERROR_TEXT","SUCCESS_TEXT","HandleArticle","state","openSuccessSnackBar","openErrorSnackBar","openDialog","deleteArticle","handleDelete","then","setState","setTimeout","catch","handleClose","handleDialog","fullScreen","props","loading","error","data","getChapters","sort","a","b","number","map","_id","getArticles","length","article","query","cache","readQuery","writeQuery","filter","attrs","require","image","title","description","chapters","concat","addChapter","e","preventDefault","variables"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport AddArticle from './AddArticle';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport Button from '@material-ui/core/Button';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport withMobileDialog from '@material-ui/core/withMobileDialog';\nimport SnackBarSuccess from '../SnackBar/SnackBarSuccess';\nimport SnackBarError from '../SnackBar/SnackBarError';\n\nimport { Query, Mutation } from 'react-apollo';\nimport {\n  DELETE_ARTICLE,\n  GET_ARTICLES,\n  GET_CHAPTERS,\n  ADD_CHAPTER\n} from '../../queries';\n\nconst ERROR_TEXT = 'Sorry, deleting your article did not work...';\nconst SUCCESS_TEXT = 'Great, your article is now removed!';\n\nclass HandleArticle extends Component {\n  state = {\n    openSuccessSnackBar: false,\n    openErrorSnackBar: false,\n    openDialog: false,\n    deleteArticle: {}\n  };\n\n  handleDelete = () => {\n    this.state\n      .deleteArticle()\n      .then(() => {\n        this.setState({\n          openSuccessSnackBar: true,\n          openDialog: false\n        });\n        setTimeout(() => {\n          this.setState({\n            openSuccessSnackBar: false\n          });\n        }, 3000);\n      })\n      .catch(() => {\n        this.setState({\n          openErrorSnackBar: true,\n          openDialog: false\n        });\n        setTimeout(() => {\n          this.setState({\n            openErrorSnackBar: false\n          });\n        }, 3000);\n      });\n  };\n\n  handleClose = deleteArticle => {\n    this.setState({ openDialog: false });\n  };\n\n  handleDialog = deleteArticle => {\n    this.setState({\n      openDialog: true,\n      deleteArticle: deleteArticle\n    });\n  };\n\n  render() {\n    const { fullScreen } = this.props;\n    return (\n      <Query query={GET_CHAPTERS}>\n        {({ loading, error, data }) => {\n          if (loading) return <p>Loading...</p>;\n          if (error) return <p>Error :(</p>;\n          return (\n            <div className=\"HandleArticle\">\n              {data.getChapters\n                .sort((a, b) => a.number > b.number)\n                .map(({ _id, number }) => {\n                  return (\n                    <div className=\"HandleArticle__Chapter\" key={number}>\n                      <h3 className=\"HandleArticle__Chapter__Title\">\n                        Chapitre {number}\n                      </h3>\n                      <Query query={GET_ARTICLES}>\n                        {({ data, loading, error }) => {\n                          if (loading)\n                            return (\n                              <CircularProgress className=\"Spinner\" size={50} />\n                            );\n                          if (error) return <div>Error</div>;\n                          return (\n                            <div className=\"RemoveArticle\">\n                              <Dialog\n                                className=\"RemoveArticle__Dialog\"\n                                fullScreen={fullScreen}\n                                open={this.state.openDialog}\n                                onClose={this.handleClose}\n                                aria-labelledby=\"responsive-dialog-title\"\n                              >\n                                <DialogTitle\n                                  className=\"RemoveArticle__Dialog__Title\"\n                                  id=\"responsive-dialog-title\"\n                                >\n                                  {'Remove Article'}\n                                </DialogTitle>\n                                <DialogContent>\n                                  <DialogContentText>\n                                    Are you sure you want to delete this\n                                    article?\n                                  </DialogContentText>\n                                </DialogContent>\n                                <DialogActions>\n                                  <Button\n                                    onClick={this.handleDelete}\n                                    color=\"primary\"\n                                  >\n                                    Yes\n                                  </Button>\n                                  <Button\n                                    onClick={this.handleClose}\n                                    color=\"primary\"\n                                    autoFocus\n                                  >\n                                    No\n                                  </Button>\n                                </DialogActions>\n                              </Dialog>\n                              <SnackBarSuccess\n                                text={SUCCESS_TEXT}\n                                open={this.state.openSuccessSnackBar}\n                              />\n                              <SnackBarError\n                                text={ERROR_TEXT}\n                                open={this.state.openErrorSnackBar}\n                              />\n                              {!data.getArticles.length && (\n                                <p>\n                                  <strong>\n                                    You have not added any articles yet\n                                  </strong>\n                                </p>\n                              )}\n                              <div className=\"RemoveArticle__Articles\">\n                                {data.getArticles.map(article => (\n                                  <div\n                                    className=\"RemoveArticle__Articles__Article\"\n                                    key={article._id}\n                                  >\n                                    <Mutation\n                                      mutation={DELETE_ARTICLE}\n                                      variables={{ _id: article._id }}\n                                      refetchQueries={() => [\n                                        { query: GET_ARTICLES }\n                                      ]}\n                                      update={(\n                                        cache,\n                                        { data: { deleteArticle } }\n                                      ) => {\n                                        const { getArticles } = cache.readQuery(\n                                          {\n                                            query: GET_ARTICLES\n                                          }\n                                        );\n\n                                        cache.writeQuery({\n                                          query: GET_ARTICLES,\n\n                                          data: {\n                                            getArticles: getArticles.filter(\n                                              article =>\n                                                article._id !==\n                                                deleteArticle._id\n                                            )\n                                          }\n                                        });\n                                      }}\n                                    >\n                                      {(deleteArticle, attrs = {}) => {\n                                        return (\n                                          <Card className=\"RemoveArticle__Articles__Article__Card\">\n                                            <CardMedia\n                                              className=\"RemoveArticle__Articles__Article__Card__Image\"\n                                              image={require(`../../assets/images/${\n                                                article.image\n                                              }`)}\n                                              title=\"Contemplative Reptile\"\n                                            />\n                                            <CardContent className=\"RemoveArticle__Articles__Article__Card__Content\">\n                                              <Typography\n                                                gutterBottom\n                                                variant=\"headline\"\n                                                component=\"h2\"\n                                                className=\"RemoveArticle__Articles__Article__Card__Content__Title\"\n                                              >\n                                                {article.title}\n                                              </Typography>\n                                              <Typography component=\"p\">\n                                                {article.description}\n                                              </Typography>\n                                            </CardContent>\n                                            <CardActions className=\"RemoveArticle__Articles__Article__Card__Action\">\n                                              <Button\n                                                size=\"small\"\n                                                onClick={() =>\n                                                  this.handleDialog(\n                                                    deleteArticle\n                                                  )\n                                                }\n                                                color=\"primary\"\n                                                variant=\"outlined\"\n                                                className=\"RemoveArticle__Articles__Article__Card__Action__Button\"\n                                              >\n                                                {attrs.loading\n                                                  ? 'deleting...'\n                                                  : 'DELETE'}\n                                              </Button>\n                                            </CardActions>\n                                          </Card>\n                                        );\n                                      }}\n                                    </Mutation>\n                                  </div>\n                                ))}\n                              </div>\n                            </div>\n                          );\n                        }}\n                      </Query>\n                      <NavLink\n                        className=\"HandleArticle__Chapter__AddArticle\"\n                        to={`/admin/backoffice/addArticle/chapter/${number}`}\n                      >\n                        ADD AN ARTICLE\n                      </NavLink>\n                    </div>\n                  );\n                })}\n              <Mutation\n                mutation={ADD_CHAPTER}\n                update={(cache, { data }) => {\n                  const chapters = cache.readQuery({\n                    query: GET_CHAPTERS\n                  }).getChapters;\n                  cache.writeQuery({\n                    query: GET_CHAPTERS,\n                    data: {\n                      getChapters: chapters.concat([data.addChapter])\n                    }\n                  });\n                }}\n              >\n                {(addChapter, { loading, error }) => (\n                  <div>\n                    <form\n                      className=\"HandleArticle__AddChapter\"\n                      onSubmit={e => {\n                        e.preventDefault();\n                        addChapter({\n                          variables: { number: data.getChapters.length + 1 }\n                        });\n                      }}\n                    >\n                      <Button\n                        className=\"HandleArticle__AddChapter__Button\"\n                        variant=\"outlined\"\n                        type=\"submit\"\n                      >\n                        {loading ? 'Loading...' : 'Add a chapter'}\n                      </Button>\n                    </form>\n                    {error && <p>Error :( Please try again</p>}\n                  </div>\n                )}\n              </Mutation>\n            </div>\n          );\n        }}\n      </Query>\n    );\n  }\n}\n\nexport default withMobileDialog()(HandleArticle);\n"]},"metadata":{},"sourceType":"module"}